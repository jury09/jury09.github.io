<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.2',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="çœ‹é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œå¹¶å‘ç¼–ç¨‹è¿™å—æœ‰ä¸€æ¡ï¼šçº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨Executorså»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ThreadPoolExecutorçš„æ–¹å¼ï¼Œé€šè¿‡æºç åˆ†æç¦ç”¨çš„åŸå› ã€‚  é€šè¿‡è¿™ç¯‡æ–‡ç« å¯ä»¥äº†è§£åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š   çº¿ç¨‹æ± çš„å®šä¹‰ Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼ ThreadPoolExecutorå¯¹è±¡ çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³» Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡">
<meta name="keywords" content="Linuxã€PHPã€Swooleã€JAVAã€Vue.js">
<meta property="og:type" content="article">
<meta property="og:title" content="javaçº¿ç¨‹æ± è¯¥å¦‚ä½•åˆ›å»º">
<meta property="og:url" content="http:&#x2F;&#x2F;jury09.github.io&#x2F;2019&#x2F;11&#x2F;28&#x2F;java%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%AF%A5%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA&#x2F;index.html">
<meta property="og:site_name" content="Jury&#39;s Blog">
<meta property="og:description" content="çœ‹é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œå¹¶å‘ç¼–ç¨‹è¿™å—æœ‰ä¸€æ¡ï¼šçº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨Executorså»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ThreadPoolExecutorçš„æ–¹å¼ï¼Œé€šè¿‡æºç åˆ†æç¦ç”¨çš„åŸå› ã€‚  é€šè¿‡è¿™ç¯‡æ–‡ç« å¯ä»¥äº†è§£åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š   çº¿ç¨‹æ± çš„å®šä¹‰ Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼ ThreadPoolExecutorå¯¹è±¡ çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³» Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-11-28T02:17:27.414Z">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://jury09.github.io/2019/11/28/java%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%AF%A5%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>javaçº¿ç¨‹æ± è¯¥å¦‚ä½•åˆ›å»º | Jury's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jury's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">æ„Ÿæ€§åŠ¨ç‰©</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="æœç´¢..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://jury09.github.io/2019/11/28/java%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%AF%A5%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Jury">
      <meta itemprop="description" content="Stay Hungry Stay Foolish!ğŸš€">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jury's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          javaçº¿ç¨‹æ± è¯¥å¦‚ä½•åˆ›å»º
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-28 09:26:18 / ä¿®æ”¹æ—¶é—´ï¼š10:17:27" itemprop="dateCreated datePublished" datetime="2019-11-28T09:26:18+08:00">2019-11-28</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>çœ‹é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œå¹¶å‘ç¼–ç¨‹è¿™å—æœ‰ä¸€æ¡ï¼šçº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨Executorså»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ThreadPoolExecutorçš„æ–¹å¼ï¼Œé€šè¿‡æºç åˆ†æç¦ç”¨çš„åŸå› ã€‚</p>
</blockquote>
<p>é€šè¿‡è¿™ç¯‡æ–‡ç« å¯ä»¥äº†è§£åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<blockquote>
<ul>
<li>çº¿ç¨‹æ± çš„å®šä¹‰</li>
<li>Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼</li>
<li>ThreadPoolExecutorå¯¹è±¡</li>
<li>çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³»</li>
<li>Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡</li>
<li>OOMå¼‚å¸¸æµ‹è¯•</li>
<li>å¦‚ä½•å®šä¹‰çº¿ç¨‹æ± å‚æ•°</li>
</ul>
</blockquote>
<h4 id="çº¿ç¨‹æ± çš„å®šä¹‰"><a href="#çº¿ç¨‹æ± çš„å®šä¹‰" class="headerlink" title="çº¿ç¨‹æ± çš„å®šä¹‰"></a>çº¿ç¨‹æ± çš„å®šä¹‰</h4><p>ç®¡ç†ä¸€ç»„å·¥ä½œçº¿ç¨‹ï¼Œé€šè¿‡çº¿ç¨‹æ± å¤ç”¨çº¿ç¨‹æœ‰ä»¥ä¸‹å‡ ç‚¹ä¼˜ç‚¹ï¼š</p>
<blockquote>
<ul>
<li>å‡å°‘èµ„æºåˆ›å»º =&gt; å‡å°‘å†…å­˜å¼€é”€ï¼Œåˆ›å»ºçº¿ç¨‹å ç”¨å†…å­˜</li>
<li>é™ä½ç³»ç»Ÿå¼€é”€ =&gt; åˆ›å»ºçº¿ç¨‹éœ€è¦æ—¶é—´ï¼Œä¼šå»¶è¿Ÿå¤„ç†çš„è¯·æ±‚</li>
<li>æé«˜ç¨³å®šç¨³å®šæ€§ =&gt; é¿å…æ— é™åˆ›å»ºçº¿ç¨‹å¼•èµ·çš„OutOfMemoryErrorã€ç®€ç§°OOMã€‘</li>
</ul>
</blockquote>
<h4 id="Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼"><a href="#Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼" class="headerlink" title="Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼"></a>Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼</h4><p>æ ¹æ®è¿”å›çš„å¯¹è±¡ç±»å‹åˆ›å»ºçº¿ç¨‹æ± å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<blockquote>
<ul>
<li>åˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡</li>
<li>åˆ›å»ºè¿”å›ScheduleThreadPoolExecutorå¯¹è±¡</li>
<li>åˆ›å»ºè¿”å›ForkJoinPoolå¯¹è±¡</li>
</ul>
</blockquote>
<p>æœ¬æ–‡åªè®¨è®ºåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡</p>
<h4 id="ThreadPoolExecutorå¯¹è±¡"><a href="#ThreadPoolExecutorå¯¹è±¡" class="headerlink" title="ThreadPoolExecutorå¯¹è±¡"></a>ThreadPoolExecutorå¯¹è±¡</h4><p>åœ¨ä»‹ç»Executorsåˆ›å»ºçº¿ç¨‹æ± æ–¹æ³•å‰å…ˆä»‹ç»ä¸€ä¸‹ThreadPoolExecutorï¼Œå› ä¸ºè¿™äº›åˆ›å»ºçº¿ç¨‹æ± çš„é™æ€æ–¹æ³•éƒ½æ˜¯è¿”å›ThreadPoolExecutorå¯¹è±¡ï¼Œå’Œæˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºThreadPoolExecutorå¯¹è±¡çš„åŒºåˆ«å°±æ˜¯æˆ‘ä»¬ä¸éœ€è¦è‡ªå·±ä¼ æ„é€ å‡½æ•°çš„å‚æ•°ã€‚</p>
<p>ThreadPoolExecutorçš„æ„é€ å‡½æ•°å…±æœ‰å››ä¸ªï¼Œä½†æœ€ç»ˆè°ƒç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public ThreadPoolExecutor(int corePoolSize,</span><br><span class="line">                          int maximumPoolSize,</span><br><span class="line">                          long keepAliveTime,</span><br><span class="line">                          TimeUnit unit,</span><br><span class="line">                          BlockingQueue&lt;Runnable&gt; workQueue,</span><br><span class="line">                          ThreadFactory threadFactory,</span><br><span class="line">                          RejectedExecutionHandler handler)</span><br></pre></td></tr></table></figure>
<p>æ„é€ å‡½æ•°å‚æ•°è¯´æ˜ï¼š</p>
<blockquote>
<ul>
<li>corePoolSize =&gt; çº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°é‡</li>
<li>maximumPoolSize =&gt; çº¿ç¨‹æ± æœ€å¤§æ•°é‡</li>
<li>keepAliveTime =&gt; ç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´</li>
<li>unit =&gt; æ—¶é—´å•ä½</li>
<li>workQueue =&gt; çº¿ç¨‹æ± æ‰€ä½¿ç”¨çš„ç¼“å†²é˜Ÿåˆ—</li>
<li>threadFactory =&gt; çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹ä½¿ç”¨çš„å·¥å‚</li>
<li>handler =&gt; çº¿ç¨‹æ± å¯¹æ‹’ç»ä»»åŠ¡çš„å¤„ç†ç­–ç•¥</li>
</ul>
</blockquote>
<h4 id="çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³»"><a href="#çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³»" class="headerlink" title="çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³»"></a>çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³»</h4><p>æ‰§è¡Œé€»è¾‘è¯´æ˜ï¼š</p>
<blockquote>
<ul>
<li>åˆ¤æ–­æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯å¦å·²æ»¡ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å¤§å°å’ŒcorePoolSizeå‚æ•°æœ‰å…³ï¼Œæœªæ»¡åˆ™åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡</li>
<li>è‹¥æ ¸å¿ƒçº¿ç¨‹æ± å·²æ»¡ï¼Œåˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦æ»¡ï¼Œé˜Ÿåˆ—æ˜¯å¦æ»¡å’ŒworkQueueå‚æ•°æœ‰å…³ï¼Œè‹¥æœªæ»¡åˆ™åŠ å…¥é˜Ÿåˆ—ä¸­</li>
<li>è‹¥é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ¤æ–­éæ ¸å¿ƒçº¿ç¨‹æ± æ˜¯å¦å·²æ»¡ï¼Œéæ ¸å¿ƒçº¿ç¨‹æ± æ˜¯å¦å·²æ»¡å’ŒmaximumPoolSizeå‚æ•°æœ‰å…³ï¼Œè‹¥æœªæ»¡åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡</li>
<li>è‹¥çº¿ç¨‹æ± å·²æ»¡ï¼Œåˆ™é‡‡ç”¨æ‹’ç»ç­–ç•¥å¤„ç†æ— æ³•æ‰§æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæ‹’ç»ç­–ç•¥å’Œhandlerå‚æ•°æœ‰å…³</li>
</ul>
</blockquote>
<h4 id="Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡"><a href="#Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡" class="headerlink" title="Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡"></a>Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡</h4><p>Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡çš„æ–¹æ³•å…±æœ‰ä¸‰ç§ï¼š</p>
<blockquote>
<ul>
<li>Executors#newCachedThreadPool =&gt; åˆ›å»ºå¯ç¼“å­˜çš„çº¿ç¨‹æ± </li>
<li>Executors#newSingleThreadExecutor =&gt; åˆ›å»ºå•çº¿ç¨‹çš„çº¿ç¨‹æ± </li>
<li>Executors#newFixedThreadPool =&gt; åˆ›å»ºå›ºå®šé•¿åº¦çš„çº¿ç¨‹æ± </li>
</ul>
</blockquote>
<h5 id="Executors-newCachedThreadPoolæ–¹æ³•"><a href="#Executors-newCachedThreadPoolæ–¹æ³•" class="headerlink" title="Executors#newCachedThreadPoolæ–¹æ³•"></a>Executors#newCachedThreadPoolæ–¹æ³•</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static ExecutorService newCachedThreadPool() &#123;</span><br><span class="line">    return new ThreadPoolExecutor(0, Integer.MAX_VALUE,</span><br><span class="line">                                  60L, TimeUnit.SECONDS,</span><br><span class="line">                                  new SynchronousQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CachedThreadPoolæ˜¯ä¸€ä¸ªæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œå‚æ•°å¦‚ä¸‹ï¼š</p>
<blockquote>
<ul>
<li>corePoolSize =&gt; 0ï¼Œæ ¸å¿ƒçº¿ç¨‹æ± çš„æ•°é‡ä¸º0</li>
<li>maximumPoolSize =&gt; Integer.MAX_VALUEï¼Œå¯ä»¥è®¤ä¸ºæœ€å¤§çº¿ç¨‹æ•°æ˜¯æ— é™çš„</li>
<li>keepAliveTime =&gt; 60L</li>
<li>unit =&gt; ç§’</li>
<li>workQueue =&gt; SynchronousQueue</li>
</ul>
</blockquote>
<p>å½“ä¸€ä¸ªä»»åŠ¡æäº¤æ—¶ï¼ŒcorePoolSizeä¸º0ä¸åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹ï¼ŒSynchronousQueueæ˜¯ä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜Ÿåˆ—ï¼Œå¯ä»¥ç†è§£ä¸ºé˜Ÿé‡Œæ°¸è¿œæ˜¯æ»¡çš„ï¼Œå› æ­¤æœ€ç»ˆä¼šåˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p>
<p>å¯¹äºéæ ¸å¿ƒçº¿ç¨‹ç©ºé—²60sæ—¶å°†è¢«å›æ”¶ã€‚å› ä¸ºInteger.MAX_VALUEéå¸¸å¤§ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å¯ä»¥æ— é™åˆ›å»ºçº¿ç¨‹çš„ï¼Œåœ¨èµ„æºæœ‰é™çš„æƒ…å†µä¸‹å®¹æ˜“å¼•èµ·OOMå¼‚å¸¸ã€‚</p>
<h5 id="Executors-newSingleThreadExecutoræ–¹æ³•"><a href="#Executors-newSingleThreadExecutoræ–¹æ³•" class="headerlink" title="Executors#newSingleThreadExecutoræ–¹æ³•"></a>Executors#newSingleThreadExecutoræ–¹æ³•</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public static ExecutorService newSingleThreadExecutor() &#123;</span><br><span class="line">    return new FinalizableDelegatedExecutorService</span><br><span class="line">        (new ThreadPoolExecutor(1, 1,</span><br><span class="line">                                0L, TimeUnit.MILLISECONDS,</span><br><span class="line">                                new LinkedBlockingQueue&lt;Runnable&gt;()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SingleThreadExecutoræ˜¯å•çº¿ç¨‹çº¿ç¨‹æ± ï¼Œåªæœ‰ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼Œå‚æ•°å¦‚ä¸‹ï¼š</p>
<blockquote>
<ul>
<li>corePoolSize =&gt; 1ï¼Œæ ¸å¿ƒçº¿ç¨‹æ± çš„æ•°é‡ä¸º1</li>
<li>maximumPoolSize =&gt; 1ï¼Œåªå¯ä»¥åˆ›å»ºä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹</li>
<li>keepAliveTime =&gt; 0L</li>
<li>unit =&gt; ç§’</li>
<li>workQueue =&gt; LinkedBlockingQueue</li>
</ul>
</blockquote>
<p>å½“ä¸€ä¸ªä»»åŠ¡æäº¤æ—¶ï¼Œé¦–å…ˆä¼šåˆ›å»ºä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœè¶…è¿‡æ ¸å¿ƒçº¿ç¨‹çš„æ•°é‡ï¼Œå°†ä¼šæ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå› ä¸ºLinkedBlockingQueueæ˜¯é•¿åº¦ä¸ºInteger.MAX_VALUEçš„é˜Ÿåˆ—ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æ— ç•Œé˜Ÿåˆ—ï¼Œå› æ­¤å¾€é˜Ÿåˆ—ä¸­å¯ä»¥æ’å…¥æ— é™å¤šçš„ä»»åŠ¡ï¼Œåœ¨èµ„æºæœ‰é™çš„æ—¶å€™å®¹æ˜“å¼•èµ·OOMå¼‚å¸¸ï¼ŒåŒæ—¶å› ä¸ºæ— ç•Œé˜Ÿåˆ—ï¼ŒmaximumPoolSizeå’ŒkeepAliveTimeå‚æ•°å°†æ— æ•ˆï¼Œå‹æ ¹å°±ä¸ä¼šåˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ã€‚</p>
<h5 id="Executors-newFixedThreadPoolæ–¹æ³•"><a href="#Executors-newFixedThreadPoolæ–¹æ³•" class="headerlink" title="Executors#newFixedThreadPoolæ–¹æ³•"></a>Executors#newFixedThreadPoolæ–¹æ³•</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static ExecutorService newFixedThreadPool(int nThreads) &#123;</span><br><span class="line">    return new ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">                                  0L, TimeUnit.MILLISECONDS,</span><br><span class="line">                                  new LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>FixedThreadPoolæ˜¯å›ºå®šæ ¸å¿ƒçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œå›ºå®šæ ¸å¿ƒçº¿ç¨‹æ•°ç”±ç”¨æˆ·ä¼ å…¥ï¼Œå‚æ•°å¦‚ä¸‹ï¼š</p>
<blockquote>
<ul>
<li>corePoolSize =&gt; 1ï¼Œæ ¸å¿ƒçº¿ç¨‹æ± çš„æ•°é‡ä¸º1</li>
<li>maximumPoolSize =&gt; 1ï¼Œåªå¯ä»¥åˆ›å»ºä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹</li>
<li>keepAliveTime =&gt; 0L</li>
<li>unit =&gt; ç§’</li>
<li>workQueue =&gt; LinkedBlockingQueue</li>
</ul>
</blockquote>
<p>å®ƒå’ŒSingleThreadExecutorç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æ ¸å¿ƒçº¿ç¨‹æ•°ä¸åŒï¼Œå¹¶ä¸”ç”±äºä½¿ç”¨çš„æ˜¯LinkedBlockingQueueï¼Œåœ¨èµ„æºæœ‰é™çš„æ—¶å€™å®¹æ˜“å¼•èµ·OOMå¼‚å¸¸ã€‚</p>
<h4 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h4><blockquote>
<ul>
<li>FixedThreadPoolå’ŒSingleThreadExecutor =&gt; å…è®¸çš„è¯·æ±‚é˜Ÿåˆ—é•¿åº¦ä¸ºInteger.MAX_VALUEï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¼•èµ·OOMå¼‚å¸¸</li>
<li>CachedThreadPool =&gt; å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°ä¸ºInteger.MAX_VALUEï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çš„çº¿ç¨‹ï¼Œä»è€Œå¼•èµ·OOMå¼‚å¸¸</li>
</ul>
</blockquote>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¦æ­¢ä½¿ç”¨Executorså»åˆ›å»ºçº¿ç¨‹æ± ï¼Œè€Œæ˜¯æ¨èè‡ªå·±å»åˆ›å»ºThreadPoolExecutorçš„åŸå› ã€‚</p>
<h4 id="OOMå¼‚å¸¸æµ‹è¯•"><a href="#OOMå¼‚å¸¸æµ‹è¯•" class="headerlink" title="OOMå¼‚å¸¸æµ‹è¯•"></a>OOMå¼‚å¸¸æµ‹è¯•</h4><p>ç†è®ºä¸Šä¼šå‡ºç°OOMå¼‚å¸¸ï¼Œå¿…é¡»æµ‹è¯•ä¸€æ³¢éªŒè¯ä¹‹å‰çš„è¯´æ³•ï¼š</p>
<p>æµ‹è¯•ç±»ï¼šTaskTest.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class TaskTest &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ExecutorService es = Executors.newCachedThreadPool();</span><br><span class="line">        int i = 0;</span><br><span class="line">        while (true) &#123;</span><br><span class="line">            es.submit(new Task(i++));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨Executorsåˆ›å»ºçš„CachedThreadPoolï¼Œå¾€çº¿ç¨‹æ± ä¸­æ— é™æ·»åŠ çº¿ç¨‹</p>
<p>åœ¨å¯åŠ¨æµ‹è¯•ç±»ä¹‹å‰å…ˆå°†JVMå†…å­˜è°ƒæ•´å°ä¸€ç‚¹ï¼Œä¸ç„¶å¾ˆå®¹æ˜“å°†ç”µè„‘è·‘å‡ºé—®é¢˜ï¼Œåœ¨ideaé‡Œï¼šRun -&gt; Edit Configurations</p>
<p>JVMå‚æ•°è¯´æ˜ï¼š</p>
<blockquote>
<ul>
<li>-Xms10M =&gt; Java Heapå†…å­˜åˆå§‹åŒ–å€¼</li>
<li>-Xmx10M =&gt; Java Heapå†…å­˜æœ€å¤§å€¼</li>
</ul>
</blockquote>
<h4 id="å¦‚ä½•å®šä¹‰çº¿ç¨‹æ± å‚æ•°"><a href="#å¦‚ä½•å®šä¹‰çº¿ç¨‹æ± å‚æ•°" class="headerlink" title="å¦‚ä½•å®šä¹‰çº¿ç¨‹æ± å‚æ•°"></a>å¦‚ä½•å®šä¹‰çº¿ç¨‹æ± å‚æ•°</h4><p><strong>CPUå¯†é›†å‹</strong> =&gt; çº¿ç¨‹æ± çš„å¤§å°æ¨èä¸ºCPUæ•°é‡ + 1ï¼ŒCPUæ•°é‡å¯ä»¥æ ¹æ®Runtime.availableProcessorsæ–¹æ³•è·å–</p>
<p><strong>IOå¯†é›†å‹</strong> =&gt; CPUæ•°é‡ * CPUåˆ©ç”¨ç‡ * (1 + çº¿ç¨‹ç­‰å¾…æ—¶é—´/çº¿ç¨‹CPUæ—¶é—´)</p>
<p><strong>æ··åˆå‹</strong> =&gt; å°†ä»»åŠ¡åˆ†ä¸ºCPUå¯†é›†å‹å’ŒIOå¯†é›†å‹ï¼Œç„¶ååˆ†åˆ«ä½¿ç”¨ä¸åŒçš„çº¿ç¨‹æ± å»å¤„ç†ï¼Œä»è€Œä½¿æ¯ä¸ªçº¿ç¨‹æ± å¯ä»¥æ ¹æ®å„è‡ªçš„å·¥ä½œè´Ÿè½½æ¥è°ƒæ•´</p>
<p><strong>é˜»å¡é˜Ÿåˆ—</strong> =&gt; æ¨èä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼Œæœ‰ç•Œé˜Ÿåˆ—æœ‰åŠ©äºé¿å…èµ„æºè€—å°½çš„æƒ…å†µå‘ç”Ÿ</p>
<p><strong>æ‹’ç»ç­–ç•¥</strong> =&gt; é»˜è®¤é‡‡ç”¨çš„æ˜¯AbortPolicyæ‹’ç»ç­–ç•¥ï¼Œç›´æ¥åœ¨ç¨‹åºä¸­æŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ã€å› ä¸ºæ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸å¼ºåˆ¶catchã€‘ï¼Œè¿™ç§å¤„ç†æ–¹å¼ä¸å¤Ÿä¼˜é›…ã€‚å¤„ç†æ‹’ç»ç­–ç•¥æœ‰ä»¥ä¸‹å‡ ç§æ¯”è¾ƒæ¨èï¼š</p>
<ul>
<li>é’ˆå¯¹é»˜è®¤çš„AbortPolicyæ‹’ç»ç­–ç•¥,åœ¨ç¨‹åºä¸­æ•è·RejectedExecutionExceptionå¼‚å¸¸ï¼Œåœ¨æ•è·å¼‚å¸¸ä¸­å¯¹ä»»åŠ¡è¿›è¡Œå¤„ç†ã€‚</li>
<li>ä½¿ç”¨CallerRunsPolicyæ‹’ç»ç­–ç•¥ï¼Œè¯¥ç­–ç•¥ä¼šå°†ä»»åŠ¡äº¤ç»™è°ƒç”¨executeçš„çº¿ç¨‹æ‰§è¡Œã€ä¸€èˆ¬ä¸ºä¸»çº¿ç¨‹ã€‘ï¼Œæ­¤æ—¶ä¸»çº¿ç¨‹å°†åœ¨ä¸€æ®µæ—¶é—´å†…ä¸èƒ½æäº¤ä»»ä½•ä»»åŠ¡ï¼Œä»è€Œä½¿å·¥ä½œçº¿ç¨‹å¤„ç†æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚æ­¤æ—¶æäº¤çš„çº¿ç¨‹å°†è¢«ä¿å­˜åœ¨TCPé˜Ÿåˆ—ä¸­ï¼ŒTCPé˜Ÿåˆ—æ»¡å°†ä¼šå½±å“å®¢æˆ·ç«¯ï¼Œè¿™æ˜¯ä¸€ç§å¹³ç¼“çš„æ€§èƒ½é™ä½ã€‚</li>
<li>è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥ï¼Œåªéœ€è¦å®ç°RejectedExecutionHandleræ¥å£å³å¯ã€‚</li>
<li>å¦‚æœä»»åŠ¡ä¸æ˜¯ç‰¹åˆ«é‡è¦ï¼Œä½¿ç”¨DiscardPolicyå’ŒDiscardOldestPolicyæ‹’ç»ç­–ç•¥å°†ä»»åŠ¡ä¸¢å¼ƒä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</li>
</ul>
<p>å¦‚æœä½¿ç”¨Executorsçš„é™æ€æ–¹æ³•åˆ›å»ºThreadPoolExecutorå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨Semaphoreå¯¹ä»»åŠ¡çš„æ‰§è¡Œè¿›è¡Œé™æµä¹Ÿå¯ä»¥é¿å…å‡ºç°OOMå¼‚å¸¸ã€‚</p>

    </div>

    
    
    

      <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
                <a href="/2019/10/29/hello-world/" rel="next" title="Hello World">
                  <i class="fa fa-chevron-left"></i> Hello World
                </a>
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
            </div>
          </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#çº¿ç¨‹æ± çš„å®šä¹‰"><span class="nav-number">1.</span> <span class="nav-text">çº¿ç¨‹æ± çš„å®šä¹‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼"><span class="nav-number">2.</span> <span class="nav-text">Executorsåˆ›å»ºçº¿ç¨‹æ± çš„å‡ ç§æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ThreadPoolExecutorå¯¹è±¡"><span class="nav-number">3.</span> <span class="nav-text">ThreadPoolExecutorå¯¹è±¡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³»"><span class="nav-number">4.</span> <span class="nav-text">çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡é€»è¾‘å’Œçº¿ç¨‹æ± å‚æ•°çš„å…³ç³»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡"><span class="nav-number">5.</span> <span class="nav-text">Executorsåˆ›å»ºè¿”å›ThreadPoolExecutorå¯¹è±¡</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Executors-newCachedThreadPoolæ–¹æ³•"><span class="nav-number">5.1.</span> <span class="nav-text">Executors#newCachedThreadPoolæ–¹æ³•</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Executors-newSingleThreadExecutoræ–¹æ³•"><span class="nav-number">5.2.</span> <span class="nav-text">Executors#newSingleThreadExecutoræ–¹æ³•</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Executors-newFixedThreadPoolæ–¹æ³•"><span class="nav-number">5.3.</span> <span class="nav-text">Executors#newFixedThreadPoolæ–¹æ³•</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ€»ç»“ï¼š"><span class="nav-number">6.</span> <span class="nav-text">æ€»ç»“ï¼š</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#OOMå¼‚å¸¸æµ‹è¯•"><span class="nav-number">7.</span> <span class="nav-text">OOMå¼‚å¸¸æµ‹è¯•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¦‚ä½•å®šä¹‰çº¿ç¨‹æ± å‚æ•°"><span class="nav-number">8.</span> <span class="nav-text">å¦‚ä½•å®šä¹‰çº¿ç¨‹æ± å‚æ•°</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="Jury"
    src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Jury</p>
  <div class="site-description" itemprop="description">Stay Hungry Stay Foolish!ğŸš€</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jury</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.4.2
  </div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>













  

  

</body>
</html>
